--------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------
----------SSSSQ---SQ--------S------S-SSSQS-----Q-------X-----------------------------------------------------------SSSS---------SSSS--------
--------------------------------------------------------------------------------------------------------------------------------------------
---------E----------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------
----S--S?S---------SQ-----------Q--QS-Q--------S---XX------------------------------------------X--XXX--X------<>--------------QS----------->
---------------------------------------------------XX------------------------------------------X--XX---XX-----[]---------------------------]
-------------------------------------------------XXXX--<-----------------------------------<>-XX--XXX--XXX----[]--------------------------[]
-------------EEEE---E-EEXE-E-----------E-E-E-E--EXXXX--[--------E----E-E---------------E---[]XXX--XXX-XXXXX---[]--------------------------[]
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX--XXXXXXXXXXXXXXXXXXXX----XXXXXXXXX--XXXXXXX